<div class="min-h-screen text-neutral-100 antialiased w-screen flex">
  <div
    class="mx-auto relative my-10 w-full md:w-[80vw] p-6 sm:p-10 flex flex-col lg:flex-row gap-6 items-stretch rounded-none sm:rounded-2xl bg-neutral-600/60"
  >
    <div
      class="hidden lg:block absolute top-2 right-2 cursor-pointer"
      (click)="close()"
    >
      <img src="/icons/close.svg" alt="" class="size-8" />
    </div>
    @if(user.providers.includes('github')){
    <section
      class="relative rounded-2xl border border-white/10 bg-neutral-950/50 p-6 shadow-xl backdrop-blur-sm w-full lg:w-1/2 flex flex-col justify-around"
      aria-labelledby="import-title"
    >
      <div class="flex items-center gap-4">
        <div
          class="lg:hidden cursor-pointer flex justify-center items-center"
          (click)="close()"
        >
          <img src="/icons/back.svg" alt="" class="size-8" />
        </div>
        <h2
          id="import-title"
          class="text-2xl font-semibold -translate-y-0.5 tracking-tight"
        >
          Import Your Git Repositories
        </h2>
      </div>
      <div class="mt-5 grid grid-cols-1 gap-3 sm:grid-cols-2">
        <span class="inline-flex items-center gap-3">
          <span
            class="flex h-7 w-7 items-center justify-center rounded-full bg-neutral-800 text-xs font-medium text-neutral-300"
            aria-hidden="true"
          >
            <img src="{{ user.avatar }}" alt="" class="rounded-full" />
          </span>
          <span class="font-medium">{{ user.name }}</span>
        </span>
        <label class="relative block" aria-label="Search repositories">
          <span class="sr-only">Search</span>
          <input
            type="search"
            name="search"
            [(ngModel)]="searchTerm"
            (ngModelChange)="onSearchChange()"
            placeholder="Searchâ€¦"
            class="w-full rounded-xl border border-white/10 bg-neutral-900 pl-10 pr-3 py-2.5 text-neutral-200 placeholder:text-neutral-500 outline-none focus:border-white/20 focus:ring-2 focus:ring-white/20"
          />
          <img
            src="/icons/search.svg"
            alt=""
            class="size-4 absolute left-3.5 top-[35%]"
          />
          @if (searchTerm) {
          <button
            type="button"
            (click)="searchTerm = ''"
            class="absolute right-3 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-200"
            aria-label="Clear search"
          >
            âœ•
          </button>
          }
        </label>
      </div>
      <div
        class="mt-5 overflow-hidden rounded-xl border border-white/10 bg-neutral-900/40 h-85 overflow-y-auto repos-scrollbar"
        role="region"
        aria-label="Repository list"
      >
        @for (repo of filteredRepos; track repo.id) {
        <div
          class="flex flex-col xs:flex-row items-center justify-between gap-4 border-b border-white/10 px-4 py-4"
        >
          <div class="flex items-center gap-3">
            <div class="flex items-center gap-2 text-sm">
              <!-- ðŸ”¹ Repo name -->
              <a
                [href]="'https://github.com/' + repo.username + '/' + repo.name"
                class="font-medium text-neutral-100 underline-offset-4 hover:underline"
                >{{ repo.username }}/{{ repo.name }}</a
              >

              <span class="text-neutral-500">â€¢</span>

              <!-- ðŸ”¹ Last commit date (formatted) -->
              <span class="text-neutral-400">
                {{ repo.lastCommit }}
              </span>
            </div>
          </div>

          <button
            class="deploy rounded-lg text-sm font-medium"
            (click)="startdeploy(repo); deployandclose()"
          >
            Deploy
          </button>
        </div>
        }
      </div>
    </section>
    }@else {
    <section
      class="relative rounded-2xl border border-white/10 bg-neutral-950/50 p-6 shadow-xl backdrop-blur-sm w-full lg:w-1/2 flex flex-col justify-center gap-10 md:gap-15"
      aria-labelledby="import-title"
    >
      <h2
        class="text-2xl font-semibold -translate-y-0.5 tracking-tight text-center"
      >
        Import Your Git Repositories
      </h2>
      <button
        (click)="login('github')"
        class="inline-flex w-2/3 self-center items-center cursor-pointer gap-2 rounded-2xl bg-white px-4 py-2 text-[clamp(0.8rem,1vw,1.2rem)] font-medium text-black shadow-sm hover:bg-neutral-300"
      >
        <span class="flex h-6 w-6 items-center justify-center">
          <svg
            class="h-4 w-4"
            viewBox="0 0 24 24"
            fill="none"
            aria-hidden="true"
          >
            <path
              d="M12 5v14M5 12h14"
              stroke="currentColor"
              stroke-width="1.8"
              stroke-linecap="round"
            />
          </svg>
        </span>
        Connect to your GitHub Account
      </button>
    </section>
    }
    <section
      class="rounded-2xl border border-white/10 bg-neutral-950/50 p-6 shadow-xl backdrop-blur-sm w-full lg:w-1/2 flex flex-col justify-center gap-10"
    >
      <img src="/icons/github.svg" alt="" class="self-center size-40" />
      <h1
        class="text-center text-2xl font-semibold tracking-tight px-5 lg:px-10"
      >
        Or You Can Import Third-Party Git Repository
      </h1>
      <div class="w-full flex flex-col md:flex-row gap-4">
        <div class="flex-1 flex min-w-56 items-center px-0 md:px-2">
          <input
            type="url"
            name="giturl"
            [(ngModel)]="urlInput"
            id="giturl"
            placeholder=" "
            class="peer url w-full"
          />
          <label for="giturl" class="label">
            Enter your GitHub repo link...
          </label>
        </div>
        <div class="w-full md:w-auto flex items-center px-0 md:px-2">
          <button
            class="deploy rounded-3xl w-full md:w-auto text-lg font-semibold"
            (click)="startdeploywithUrl(urlInput); deployandclose()"
          >
            Deploy
          </button>
        </div>
      </div>
    </section>
  </div>
</div>
